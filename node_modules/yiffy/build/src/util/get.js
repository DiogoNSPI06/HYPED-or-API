"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const Constants_1 = require("./Constants");
const https_1 = __importDefault(require("https"));
const url_1 = require("url");
async function get(url, ua, auth, host) {
    return new Promise((a, b) => {
        const u = new url_1.URL(url);
        https_1.default
            .get({
            host: u.host,
            path: `${u.pathname}${u.search}`,
            port: url.indexOf("https") !== -1 ? 443 : 80,
            method: "GET",
            headers: {
                "User-Agent": ua,
                "Host": host || Constants_1.API_HOST,
                ...(auth ? ({
                    Authorization: auth
                }) : ({}))
            }
        }, (res) => {
            const d = [];
            res
                .on("data", d.push.bind(d))
                .on("error", (err) => b(err))
                .on("end", () => a({
                headers: res.headers,
                body: Buffer.concat(d),
                statusCode: res.statusCode,
                statusMessage: res.statusMessage
            }));
        })
            .end();
    });
}
exports.default = get;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3V0aWwvZ2V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsMkNBQXVDO0FBQ3ZDLGtEQUEwQjtBQUMxQiw2QkFBMEI7QUFFWCxLQUFLLFVBQVUsR0FBRyxDQUFDLEdBQVcsRUFBRSxFQUFVLEVBQUUsSUFBYSxFQUFFLElBQWE7SUFNdEYsT0FBTyxJQUFJLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTtRQUMzQixNQUFNLENBQUMsR0FBRyxJQUFJLFNBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUN2QixlQUFLO2FBQ0gsR0FBRyxDQUFDO1lBQ0osSUFBSSxFQUFFLENBQUMsQ0FBQyxJQUFJO1lBQ1osSUFBSSxFQUFFLEdBQUcsQ0FBQyxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFO1lBQ2hDLElBQUksRUFBRSxHQUFHLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUU7WUFDNUMsTUFBTSxFQUFFLEtBQUs7WUFDYixPQUFPLEVBQUU7Z0JBQ1IsWUFBWSxFQUFFLEVBQUU7Z0JBQ2hCLE1BQU0sRUFBRSxJQUFJLElBQUksb0JBQVE7Z0JBQ3hCLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ1gsYUFBYSxFQUFFLElBQUk7aUJBQ25CLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQzthQUNWO1NBQ0QsRUFBRSxDQUFDLEdBQUcsRUFBRSxFQUFFO1lBQ1YsTUFBTSxDQUFDLEdBQWtCLEVBQUUsQ0FBQztZQUU1QixHQUFHO2lCQUNELEVBQUUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7aUJBQzFCLEVBQUUsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQztpQkFDNUIsRUFBRSxDQUFDLEtBQUssRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ2xCLE9BQU8sRUFBRSxHQUFHLENBQUMsT0FBOEQ7Z0JBQzNFLElBQUksRUFBRSxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztnQkFDdEIsVUFBVSxFQUFFLEdBQUcsQ0FBQyxVQUFXO2dCQUMzQixhQUFhLEVBQUUsR0FBRyxDQUFDLGFBQWM7YUFDakMsQ0FBQyxDQUFDLENBQUM7UUFDTixDQUFDLENBQUM7YUFDRCxHQUFHLEVBQUUsQ0FBQztJQUNULENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQXBDRCxzQkFvQ0MifQ==